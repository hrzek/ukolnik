<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Štěpán Hrzán">
<link rel="stylesheet" href="styles_l2.css"> 

  
<title>Úkolníček Helpdesk L1</title>
</head>




<body>
<div id="notificationBar"></div>



<button id="backButton" onclick="goBack()"> Zpět</button>


<script>
function goBack() {
window.history.back();
}
</script>


<h1 id="dayHeader">Úkoly na #den</h1>

 <script>
      if (sessionStorage.getItem("isLoggedIn") !== "true") {
    alert("Nemáte přístup. Přihlaste se.");
    window.location.href = "index.html";
}
        </script>
  <script>
const loggedInUser = sessionStorage.getItem("loggedInUser");


function logout() {
    sessionStorage.removeItem("isLoggedIn");
    sessionStorage.removeItem("loggedInUser");
    window.location.href = "index.html";
}

</script>

<script>
function updateDayHeader() {


const days = ['Neděle', 'Pondělí', 'Úterý', 'Středu', 'Čtvrtek', 'Pátek', 'Sobotu'];


const today = new Date();

const dayName = days[today.getDay()]; 

const header = document.getElementById('dayHeader'); 
header.innerText = `Úkoly na ${dayName}`; 
        }

updateDayHeader();

</script>






<h1></h1>
<ul id="taskList">


<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - připojení do call centra</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu ZRA01</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu MIBSALE</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu FINANCE CZ</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu FINANCE SK</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu FINANCE DE</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu HANA CZ</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu HANA SK</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu HANA DE</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu SD plánování</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu Personalistika</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - BI_kontrola procesu HR mzdy CZ</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - Kontrola spuštění procesu vytváření objednávek v SAP SM37</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - SAP_kontrola procesu ZWPERM</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - v BI - kontrola iDoců - statusy -> nastavit rozsah min. 5 dní zpět. BD87</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - kontrola iDoců - statusy -> nastavit rozsah min. 5 dní zpět. BD87</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 5:30 - Zpracování Bio certifikátů pro LMS</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 6:00 - Kontrola chyb e-shopů v SAP JTI</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 6:00 - Kontrola automatických závozů zboží pro eshopy v SAP</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 6:00 - Infina - kontrola nočních importů</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="highlight hidden"><input type="checkbox"> 6:00 - Kontrola automatických závozů zboží pro eshopy v SAP</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 7:00 - Kontrola průběhu procesu Logistika CZ</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 8:00 - připojení do call centra - CZ + SK zákazníka a B2B linka</li> </label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 8:30 - Kontrola průběhu procesu Logistika SK</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 9:30 - Kontrola průběhu procesu Logistika DE</li></label>
<label><li data-day="5" class="hidden"><input type="checkbox"> 9:50 - Kontrola zpracování avíz JRK v SAP</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 10:00 - Kontrola průběhu procesu Finance - odb. CZ</li></label>
<label><li data-day="0" class="hidden"><input type="checkbox"> 12:00 - EPAY - Kontrola dat v přehledu storen</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 12:30 - Kontrola průběhu procesu Logistika CZ_SD delta- 12hod CZ</li></label>
<label><li data-day="2,3,5" class="hidden"><input type="checkbox"> 13:45 - MPK - kontrola emailu na IceWarp</li></label>
<label><li data-day="2,3,5" class="hidden"><input type="checkbox"> 14:00 - MPK - kontrola SAP složky pro MPK</li></label>
<label><li data-day="4" class="hidden"><input type="checkbox"> 14:00 - MPK - kontrola SAP složky pro JRK</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 14:00 - Kontrola rolet a trezorů v Aktionu</li></label>
<label><li data-day="2,3,5" class="hidden"><input type="checkbox"> 15:00 - Kontrola zpracování avíz MPK v SAP</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 15:00 - Kontrola vlastních a týmových tiketů + předání kolegovi + epay zapsání odpovědí</li></label>
<label><li data-day="3" class="hidden"><input type="checkbox"> 15:30 - JRK - kontrola emailu na IceWarp</li></label>
<label><li data-day="1,2,3,4,5" class="hidden"><input type="checkbox"> 18:00 - PNS kontrola na IceWarp - zaslání avíz na email</li></label>
<label><li data-day="1,2,3,4,5" class="hidden"><input type="checkbox"> 18:40 - PNS - kontrola SAP složky pro PNS</li></label>
<label><li data-day="1,2,3,4,5" class="hidden"><input type="checkbox"> 19:00 - Kontrola zpracování avíz PNS v SAP</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 20:00 - Kontrola rolet a trezorů v Aktionu</li></label>
<label><li data-day="0,1,2,3,4,5,6" class="hidden"><input type="checkbox"> 21:00 - Kontrola vlastních a týmových tiketů + předání kolegovi + epay zapsání odpovědí</li></label>
<label><li data-day="0" class="hidden"><input type="checkbox"> 21:00 - BI_kontrola procesu Výmaz PSA</li></label>
</ul>

<script>
let dnesniDen = new Date().getDay();
let ukoly = document.querySelectorAll("li[data-day]");
let taskList = document.getElementById('taskList');
taskList.innerHTML = ''; // Vymažeme všechny existující úkoly v seznamu

ukoly.forEach(ukol => {
    let dny = ukol.getAttribute("data-day").split(",").map(Number);
    if (dny.includes(dnesniDen)) {
        taskList.appendChild(ukol); // Přidáme úkol pro aktuální den
    }
});

// Přiřadíme event listener pro kliknutí na celé `li`, aby se checkbox přepnul
let listItems = document.querySelectorAll("li");
listItems.forEach(item => {
    item.addEventListener('click', (event) => {
        // Pokud bylo kliknuto na checkbox, nic nedělej, protože to už bude mít účinek
        if (event.target.type === 'checkbox') {
            return;
        }

        // Najdeme checkbox v rámci tohoto `li` a přepneme jeho stav
        let checkbox = item.querySelector("input[type='checkbox']");
        if (checkbox) {
            checkbox.checked = !checkbox.checked;
        }

        // Přepneme třídu "completed" pro označení stavu
        item.classList.toggle('completed');

        // Zapsání úkolu do historie a sessionStorage
        const taskName = item.textContent.trim();
        const userName = sessionStorage.getItem("loggedInUser") || "Neznámý uživatel";
        const now = new Date();
        const timestamp = now.toISOString(); // Uložíme čas dokončení

        let taskLog = JSON.parse(sessionStorage.getItem("taskLog")) || [];
        
        // Uložíme úkol do historie, i když je odškrtutý (ale neoznačíme ho jako "completed")
        const existingTaskIndex = taskLog.findIndex(t => t.task === taskName && t.user === userName);

        if (checkbox.checked) {
            // Pokud je úkol označený, přidáme ho do historie (pokud ještě není)
            if (existingTaskIndex === -1) {
                taskLog.push({ user: userName, task: taskName, time: timestamp, completed: true });
            } else {
                taskLog[existingTaskIndex].completed = true; // Aktualizujeme stav na "completed"
                taskLog[existingTaskIndex].time = timestamp; // Přepíšeme čas
            }
            sessionStorage.setItem("taskLog", JSON.stringify(taskLog));
            updateNotification(taskName, userName, now);
        } else {
            // Pokud je úkol odškrtnutý, aktualizujeme jeho stav v historii, ale neodstraníme ho
            if (existingTaskIndex === -1) {
                taskLog.push({ user: userName, task: taskName, time: timestamp, completed: false });
            } else {
                taskLog[existingTaskIndex].completed = false; // Nastavíme stav na "nekompletní"
                taskLog[existingTaskIndex].time = timestamp; // Přepíšeme čas
            }
            sessionStorage.setItem("taskLog", JSON.stringify(taskLog));
            clearNotification();
        }

        // Uložit stav checkboxů do localStorage
        saveCheckboxState();
    });
});

// Posluchač pro změny v checkboxu (pro zaznamenání změny do UI)
taskList.addEventListener('change', (event) => {
    if (event.target.type === 'checkbox') {
        const listItem = event.target.parentElement;
        listItem.classList.toggle('completed');

        // Zapsání úkolu do historie a sessionStorage
        const taskName = listItem.textContent.trim();
        const userName = sessionStorage.getItem("loggedInUser") || "Neznámý uživatel";
        const now = new Date();
        const timestamp = now.toISOString(); // Uložíme čas dokončení

        let taskLog = JSON.parse(sessionStorage.getItem("taskLog")) || [];
        
        const existingTaskIndex = taskLog.findIndex(t => t.task === taskName && t.user === userName);

        if (event.target.checked) {
            // Pokud je úkol označený, přidáme ho do historie (pokud ještě není)
            if (existingTaskIndex === -1) {
                taskLog.push({ user: userName, task: taskName, time: timestamp, completed: true });
            } else {
                taskLog[existingTaskIndex].completed = true; // Aktualizujeme stav na "completed"
                taskLog[existingTaskIndex].time = timestamp; // Přepíšeme čas
            }
            sessionStorage.setItem("taskLog", JSON.stringify(taskLog));
            updateNotification(taskName, userName, now);
        } else {
            // Pokud je úkol odškrtnutý, aktualizujeme jeho stav v historii, ale neodstraníme ho
            if (existingTaskIndex === -1) {
                taskLog.push({ user: userName, task: taskName, time: timestamp, completed: false });
            } else {
                taskLog[existingTaskIndex].completed = false; // Nastavíme stav na "nekompletní"
                taskLog[existingTaskIndex].time = timestamp; // Přepíšeme čas
            }
            sessionStorage.setItem("taskLog", JSON.stringify(taskLog));
            clearNotification();
        }

        // Uložit stav checkboxů do localStorage
        saveCheckboxState();
    }
});

// Funkce pro uložení stavu checkboxů do localStorage
function saveCheckboxState() {
    const checkboxes = document.querySelectorAll("#taskList input[type='checkbox']");
    let checkboxStates = {};
    
    checkboxes.forEach((checkbox, index) => {
        checkboxStates[index] = checkbox.checked;
    });

    localStorage.setItem("checkboxStates_page1", JSON.stringify(checkboxStates));
}

// Funkce pro obnovení stavu checkboxů z localStorage
function restoreCheckboxState() {
    const checkboxes = document.querySelectorAll("#taskList input[type='checkbox']");
    let checkboxStates = JSON.parse(localStorage.getItem("checkboxStates_page1")) || {};

    checkboxes.forEach((checkbox, index) => {
        if (checkboxStates[index]) {
            checkbox.checked = true;
            checkbox.parentElement.classList.add("completed");
        }
    });
}

// Funkce pro aktualizaci notifikace s časem
function updateNotification(task, user, time) {
    const now = time.toLocaleTimeString("cs-CZ", { hour: "2-digit", minute: "2-digit" });
    const notificationBar = document.getElementById("notificationBar");
    if (notificationBar) {
        notificationBar.textContent = `Poslední dokončený úkol: ${task}; Řešitel: ${user}; v čase ${now} hod.`;
    }
}

// Funkce pro výmaz notifikace
function clearNotification() {
    const notificationBar = document.getElementById("notificationBar");
    if (notificationBar) {
        notificationBar.textContent = ''; 
    }
}

// Obnova stavu checkboxů a historie při načtení stránky
document.addEventListener("DOMContentLoaded", function () {
    restoreCheckboxState();
    restoreNotification();  // Obnovíme poslední notifikaci
});

// Funkce pro obnovení notifikace
function restoreNotification() {
    let taskLog = JSON.parse(sessionStorage.getItem("taskLog")) || [];
    if (taskLog.length > 0) {
        let lastTask = taskLog[taskLog.length - 1];
        let time = new Date(lastTask.time).toLocaleTimeString("cs-CZ", { hour: "2-digit", minute: "2-digit" });
        updateNotification(lastTask.task, lastTask.user, time);
    }
}

</script>






<script>
function checkHighlighted() {
   document.querySelectorAll('.highlight input[type="checkbox"]').forEach(checkbox => {
       checkbox.checked = true;
       checkbox.parentElement.classList.add('completed'); // Přidá třídu 'completed'
   });
}

</script>

<script>
const taskList = document.getElementById('taskList');
taskList.addEventListener('change', (event) => {
if (event.target.type === 'checkbox') {
const listItem = event.target.parentElement;
listItem.classList.toggle('completed');
}
});
</script>


<button onclick="checkHighlighted()">Ranní kontrola</button>
<button id="odznac" onclick="uncheckAll()">Odznačit vše</button>
<button id= "logout" onclick="logout()">Odhlásit se</button>
<button id="history" onclick="window.location.href='history.html'">Zobrazit historii</button>

<script>
function checkHighlighted() {
   // Uložení stavu checkboxů do localStorage
   document.querySelectorAll('.highlight input[type="checkbox"]').forEach(checkbox => {
       checkbox.checked = true;
       checkbox.parentElement.classList.add('completed'); // Přidá třídu completed
   });

   // Uložení stavu do localStorage
   saveCheckboxState();
}

// Funkce pro uložení stavu checkboxů
function saveCheckboxState() {
    const checkboxStates = {};
    document.querySelectorAll('.highlight input[type="checkbox"]').forEach((checkbox, index) => {
        checkboxStates[index] = checkbox.checked;
    });
    localStorage.setItem('checkboxStates', JSON.stringify(checkboxStates));
}

// Funkce pro obnovení stavu checkboxů
function loadCheckboxState() {
    const savedState = localStorage.getItem('checkboxStates');
    if (savedState) {
        const checkboxStates = JSON.parse(savedState);
        document.querySelectorAll('.highlight input[type="checkbox"]').forEach((checkbox, index) => {
            if (checkboxStates[index] !== undefined) {
                checkbox.checked = checkboxStates[index];
                if (checkbox.checked) {
                    checkbox.parentElement.classList.add('completed');
                } else {
                    checkbox.parentElement.classList.remove('completed');
                }
            }
        });
    }
}

// Zavolání loadCheckboxState při načtení stránky, aby se stav obnovil
window.onload = loadCheckboxState;

</script>




<script>
  document.addEventListener("DOMContentLoaded", function () {
    const taskList = document.getElementById("taskList");

    taskList.addEventListener("change", function (event) {
        if (event.target && event.target.type === "checkbox") {
            const taskName = event.target.parentElement.textContent.trim();
            const userName = sessionStorage.getItem("loggedInUser") || "Neznámý uživatel";
            const now = new Date();
            const timestamp = now.toISOString(); // Uložíme čas dokončení

            let taskLog = JSON.parse(sessionStorage.getItem("taskLog")) || [];
            
            if (event.target.checked) {
                taskLog.push({ user: userName, task: taskName, time: timestamp });
                sessionStorage.setItem("taskLog", JSON.stringify(taskLog));
                updateNotification(taskName, userName, now);
            } else {
                // Pokud checkbox je odškrtnutý, odebereme jej z localStorage
                taskLog = taskLog.filter(t => t.task !== taskName);
                sessionStorage.setItem("taskLog", JSON.stringify(taskLog));
                clearNotification();
            }
            
            // Uložit stav checkboxů do localStorage
            saveCheckboxState();
        }
    });

    restoreCheckboxState(); // Při načtení stránky obnovíme checkboxy
    restoreNotification();  // Obnovíme poslední notifikaci
});
</script>

  <script>
    function saveCheckboxState() {
    const checkboxes = document.querySelectorAll("#taskList input[type='checkbox']");
    let checkboxStates = {};
    
    checkboxes.forEach((checkbox, index) => {
        checkboxStates[index] = checkbox.checked;
    });

    localStorage.setItem("checkboxStates_page1", JSON.stringify(checkboxStates));
}

function restoreCheckboxState() {
    const checkboxes = document.querySelectorAll("#taskList input[type='checkbox']");
    let checkboxStates = JSON.parse(localStorage.getItem("checkboxStates_page1")) || {};

    checkboxes.forEach((checkbox, index) => {
        if (checkboxStates[index]) {
            checkbox.checked = true;
            checkbox.parentElement.classList.add("completed");
        }
    });
}
  </script>
  <script>
   function restoreNotification() {
    let taskLog = JSON.parse(sessionStorage.getItem("taskLog")) || [];
    if (taskLog.length > 0) {
        let lastTask = taskLog[taskLog.length - 1];
        let time = new Date(lastTask.time).toLocaleTimeString("cs-CZ", { hour: "2-digit", minute: "2-digit" });
        updateNotification(lastTask.task, lastTask.user, time);
    }
}
  </script> 

<script>
function uncheckAll() {
    if (confirm("Opravu chcete vše odznačit?")) {
        document.querySelectorAll('#taskList input[type="checkbox"]').forEach(checkbox => {
            checkbox.checked = false;
            checkbox.parentElement.classList.remove('completed');
        });

        // Po odznačení všeho uložíme nový stav checkboxů do localStorage
        saveCheckboxState();
    }
}

</script>

<script>
    function logout() {
        localStorage.removeItem("isLoggedIn");
        window.location.href = "index.html";
    }
 function handleEnter(event) {
            if (event.key === "Enter") {
                validateLogin(); // Zavolání funkce přihlášení
            }
        }
</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
   const taskList = document.getElementById("taskList");
   // Připojí event listener na celý seznam úkolů
   taskList.addEventListener("change", function (event) {
       if (event.target && event.target.type === "checkbox") {
           if (event.target.checked) {
               const taskName = event.target.parentElement.textContent.trim();
               const userName = sessionStorage.getItem("loggedInUser") || "Neznámý uživatel";
               updateNotification(taskName, userName);
           }
       }
   });
});
// Funkce pro aktualizaci notifikace s časem
function updateNotification(task, user) {
   const now = new Date().toLocaleTimeString("cs-CZ", { hour: "2-digit", minute: "2-digit" });
   const notificationBar = document.getElementById("notificationBar");
   if (notificationBar) {
       
notificationBar.textContent = `Poslední dokončený úkol: ${task}  Řešitel: ${user} v čase: ${now} hod.
 `  }
}
</script>




  <script>

    
document.addEventListener("DOMContentLoaded", function () {
    const taskList = document.getElementById("taskList");

    // Připojíme event listener na změnu stavu checkboxu
    taskList.addEventListener("change", function (event) {
        if (event.target && event.target.type === "checkbox") {
            const taskName = event.target.parentElement.textContent.trim();
            const userName = sessionStorage.getItem("loggedInUser") || "Neznámý uživatel";
            const now = new Date();
            const timestamp = now.toISOString(); // Uložíme datum a čas

            // Pokud checkbox je zaškrtnutý, aktualizujeme notifikaci
            if (event.target.checked) {
                let taskLog = JSON.parse(localStorage.getItem("taskLog")) || [];
                taskLog.push({ user: userName, task: taskName, time: timestamp });
                localStorage.setItem("taskLog", JSON.stringify(taskLog));
                updateNotification(taskName, userName, now);
            } else {
                // Pokud checkbox není zaškrtnutý, vymažeme notifikaci
                clearNotification();
            }
        }
    });
});

// Funkce pro aktualizaci notifikace
function updateNotification(task, user, time) {
    const now = time.toLocaleTimeString("cs-CZ", { hour: "2-digit", minute: "2-digit" });
    const notificationBar = document.getElementById("notificationBar");
    if (notificationBar) {
        notificationBar.textContent = `Poslední dokončený úkol: ${task}; Řešitel: ${user}; v čase ${now} hod.`;
    }
}

  // Funkce pro výmaz notifikace
function clearNotification() {
    const notificationBar = document.getElementById("notificationBar");
    if (notificationBar) {
        notificationBar.textContent = ''; 
    }
}
</script>



  
</body>
</html>
